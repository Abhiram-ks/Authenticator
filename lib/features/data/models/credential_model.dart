import 'package:cloud_firestore/cloud_firestore.dart';
import 'package:authenticator/features/domain/entity/credential_entity.dart';

class CredentialModel extends CredentialEntity {
  final String? docId;
  final DateTime? createdAt;
  final DateTime? updatedAt;

  const CredentialModel({
    this.docId,
    this.createdAt,
    this.updatedAt,
    required super.uid,
    required super.name,
    super.notes = "",
    super.username,
    super.password,
    super.url,
    super.cardHolderName,
    super.cardNumber,
    super.cardType,
    super.expiryDate,
    super.pin,
    super.postalCode,
    super.firstName,
    super.lastName,
    super.sex,
    super.birthday,
    super.occupation,
    super.company,
    super.department,
    super.jobTitle,
    super.identityAddress,
    super.email,
    super.homePhone,
    super.cellPhone,
    super.addressLine1,
    super.addressLine2,
    super.city,
    super.country,
    super.state,
    super.isAddress = false,
    super.isCreditCard = false,
    super.isIdentity = false,
    super.isLogin = false,
    super.isNotes = false,
  });

  /// âœ… Factory constructor to create model from Firestore JSON
  factory CredentialModel.fromJson(Map<String, dynamic> json, String docId) {
    return CredentialModel(
      docId: docId,
      uid: json['uid'] ?? "",
      name: json['name'] ?? "",
      notes: json['notes'] ?? "",
      username: json['username'],
      password: json['password'],
      url: json['url'],
      cardHolderName: json['cardHolderName'],
      cardNumber: json['cardNumber'],
      cardType: json['cardType'],
      expiryDate: json['expiryDate'],
      pin: json['pin'],
      postalCode: json['postalCode'],
      firstName: json['firstName'],
      lastName: json['lastName'],
      sex: json['sex'],
      birthday: json['birthday'],
      occupation: json['occupation'],
      company: json['company'],
      department: json['department'],
      jobTitle: json['jobTitle'],
      identityAddress: json['identityAddress'],
      email: json['email'],
      homePhone: json['homePhone'],
      cellPhone: json['cellPhone'],
      addressLine1: json['addressLine1'],
      addressLine2: json['addressLine2'],
      city: json['city'],
      country: json['country'],
      state: json['state'],
      isAddress: json['isAddress'] ?? false,
      isCreditCard: json['isCreditCard'] ?? false,
      isIdentity: json['isIdentity'] ?? false,
      isLogin: json['isLogin'] ?? false,
      isNotes: json['isNotes'] ?? false,
      createdAt: json['createdAt'] != null
          ? (json['createdAt'] as Timestamp).toDate()
          : null,
      updatedAt: json['updatedAt'] != null
          ? (json['updatedAt'] as Timestamp).toDate()
          : null,
    );
  }

  /// âœ… Convert model to Firestore JSON
  Map<String, dynamic> toJson() {
    return {
      'uid': uid,
      'name': name,
      'notes': notes,
      'username': username,
      'password': password,
      'url': url,
      'cardHolderName': cardHolderName,
      'cardNumber': cardNumber,
      'cardType': cardType,
      'expiryDate': expiryDate,
      'pin': pin,
      'postalCode': postalCode,
      'firstName': firstName,
      'lastName': lastName,
      'sex': sex,
      'birthday': birthday,
      'occupation': occupation,
      'company': company,
      'department': department,
      'jobTitle': jobTitle,
      'identityAddress': identityAddress,
      'email': email,
      'homePhone': homePhone,
      'cellPhone': cellPhone,
      'addressLine1': addressLine1,
      'addressLine2': addressLine2,
      'city': city,
      'country': country,
      'state': state,
      'isAddress': isAddress,
      'isCreditCard': isCreditCard,
      'isIdentity': isIdentity,
      'isLogin': isLogin,
      'isNotes': isNotes,

      /// ðŸ”¹ Firestore timestamps
      'createdAt': createdAt ?? FieldValue.serverTimestamp(),
      'updatedAt': FieldValue.serverTimestamp(),
    };
  }

  /// âœ… CopyWith for easy updates
  CredentialModel copyWith({
    String? docId,
    String? uid,
    String? name,
    String? notes,
    String? username,
    String? password,
    String? url,
    String? cardHolderName,
    String? cardNumber,
    String? cardType,
    String? expiryDate,
    String? pin,
    String? postalCode,
    String? firstName,
    String? lastName,
    String? sex,
    String? birthday,
    String? occupation,
    String? company,
    String? department,
    String? jobTitle,
    String? identityAddress,
    String? email,
    String? homePhone,
    String? cellPhone,
    String? addressLine1,
    String? addressLine2,
    String? city,
    String? country,
    String? state,
    bool? isAddress,
    bool? isCreditCard,
    bool? isIdentity,
    bool? isLogin,
    bool? isNotes,
    DateTime? createdAt,
    DateTime? updatedAt,
  }) {
    return CredentialModel(
      docId: docId ?? this.docId,
      uid: uid ?? this.uid,
      name: name ?? this.name,
      notes: notes ?? this.notes,
      username: username ?? this.username,
      password: password ?? this.password,
      url: url ?? this.url,
      cardHolderName: cardHolderName ?? this.cardHolderName,
      cardNumber: cardNumber ?? this.cardNumber,
      cardType: cardType ?? this.cardType,
      expiryDate: expiryDate ?? this.expiryDate,
      pin: pin ?? this.pin,
      postalCode: postalCode ?? this.postalCode,
      firstName: firstName ?? this.firstName,
      lastName: lastName ?? this.lastName,
      sex: sex ?? this.sex,
      birthday: birthday ?? this.birthday,
      occupation: occupation ?? this.occupation,
      company: company ?? this.company,
      department: department ?? this.department,
      jobTitle: jobTitle ?? this.jobTitle,
      identityAddress: identityAddress ?? this.identityAddress,
      email: email ?? this.email,
      homePhone: homePhone ?? this.homePhone,
      cellPhone: cellPhone ?? this.cellPhone,
      addressLine1: addressLine1 ?? this.addressLine1,
      addressLine2: addressLine2 ?? this.addressLine2,
      city: city ?? this.city,
      country: country ?? this.country,
      state: state ?? this.state,
      isAddress: isAddress ?? this.isAddress,
      isCreditCard: isCreditCard ?? this.isCreditCard,
      isIdentity: isIdentity ?? this.isIdentity,
      isLogin: isLogin ?? this.isLogin,
      isNotes: isNotes ?? this.isNotes,
      createdAt: createdAt ?? this.createdAt,
      updatedAt: updatedAt ?? this.updatedAt,
    );
  }
}
